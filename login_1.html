<!DOCTYPE>
<html lang="en">

<head>

	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">

	<style type="text/css">
		body{
			background: #2196f3;
		}
	</style>

</head>

<body>

	<div class="row">
		<div class="col l12">
			<center>
				<img src="./images/logo.png" class="responsive-img" style="height: 50%; width: 40%; margin-top: 5%;"/>
			</center>
		</div>
	</div>

	<div class="row">
		<div class="col l12">
			<center>
				<div id="fb-root"></div>
          
        <!-- custom login button -->
        <a href="#" onclick="checkLoginState();"><img src="./images/sign-in-facebook.png"></a>
			</center>
		</div>
	</div>


	<!-- Import jquery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>

	  <!-- Compiled and minified JavaScript -->
  	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>

  	<script>
  // This is called with the results from from FB.getLoginStatus().
  function statusChangeCallback(response) {

    if (response.status === 'connected') {
    	fetchData();
    } else if (response.status === 'not_authorized') {
    	alert('Please log into this app.');
    } else {
    	alert('Please log into Facebook.');
    }
  }

  function checkLoginState() {
    FB.login(function(response){

      FB.getLoginStatus(function(response) {
        statusChangeCallback(response);
      });

    },{scope: 'public_profile,email,user_likes'});
  }

  window.fbAsyncInit = function() {
  FB.init({
    appId      : '756962984405203',
    cookie     : true,  // enable cookies to allow the server to access 
                        // the session
    xfbml      : true,  // parse social plugins on this page
    version    : 'v2.5' // use graph api version 2.5
  });


  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });

  };

  // Load the SDK asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  function fetchData() {
    FB.api('/me?fields=id,name,email,likes', function(response) {
      console.log(JSON.stringify(response));

      var likes_arr = new Array();
      var jsonObj = {};

      jsonObj.name = response.name;
      jsonObj.email = response.email;

      for(i=0; i< response.likes.data.length; i++){
        likes_arr[i] = response.likes.data[i].name;
      }

      jsonObj.interests = likes_arr;

        console.log(JSON.stringify(jsonObj));
        console.log(JSON.stringify(jsonObj.name));
        console.log(JSON.stringify(jsonObj.email));
        console.log(JSON.stringify(jsonObj.name));
        console.log(JSON.stringify(jsonObj.interests));


      console.log('Successful login for: ' + response.name);
    });
  }

  function logout(){
    FB.logout(function(response) {
      // Person is now logged out
    });
  }

  $(document).ready(function(){

  });

</script>

</body>


</html>